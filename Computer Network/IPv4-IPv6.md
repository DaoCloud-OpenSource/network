## IPv4 & IPv6
2019 年 11 月 25 日已分配完公网 IPv4 地址，短期内可以使用 NAT 技术进行缓解。长期来看，还是要用 128 位的 IPv6 地址替代 32 位的 IPv4 地址。

### 地址表示
- IPv4 地址长度为 32 位，使用「点分十进制表示法」，共有 4 个 8 位段，每段范围为 0 - 255。
- IPv6 地址长度为 128 位，使用冒号分隔 8 个 16 位段，每段使用十六进制表示，范围为 0000 - ffff。
- IPv6 地址有两条简化规则：
  1. 每段十六进制数中开头的 0 可以省略。例如，`2001:0db8:0042:0001:0000:0000:0000:d74c` 可以表示为 `2001:db8:42:1:0:0:0:d74c`。
  2. 由全 0 组成的连续的 16 进制数字段可以用一对冒号 `::` 表示，但只可以使用一次。例如 `2001:0db8:0042:0001:0000:0000:0000:d74c` 可以表示为 `2001:db8:42:1::d74c`。
- 网段:
  - IPv4: `192.168.0.0/16` 或 子网掩码 `255.255.0.0`
  - IPv6: `2001:db8:42:1::/112`
- Unspecified Address： IPv4 未指定地址 `0.0.0.0`， IPv6 未指定地址： `::`。从 DHCP 服务器获得 IP 地址前，使用未指定地址配置主机。如果主机监听未指定地址，则会监听主机所有的网口。
- IPv4 回环地址： `127.0.0.1/8`， IPv6 回环地址： `::1/128`


### 地址类型
IPv6 类型： 
1. 单播 Unicast
   - 全球单播地址 Global Unicast Address
   - 唯一本地地址 Unique Local Address
   - 链路本地地址 LLA, Link Local Address
2. 任意播 Anycast
3. 组播 Multicast

相比 IPv4，IPv6 没有广播地址。包含全部节点的组播地址，与 IPv4 中的广播地址功能相同。


地址类型 | 二进制格式前缀 | IPv6 前缀
:---------:|:----------:|:---------:
 未指定地址 | 00...0 | ::/128
 回环地址 | 00..1 | ::1/128
 全球单播地址 | 001 | 2000::/3
 唯一本地地址 | 1111110 | fc00::/7

#### 全球单播地址
全球单播地址类似 IPv4 中的公网 IP 地址，由 Internet 地址授权委员会（IANA, Internet Address Numbers Authority）分配给地区 Internet 注册机构（ RIR, Regional Internet Registry），再由 RIR 分配给 Internet 服务提供商（ISP, Internet Service Provider）。

IPv6 单播格式
1. 全球单播 IPv6 地址的前 3 位固定为 001。
2. 全球路由前缀由地址分配机构分配。
3. 主机位称为接口 ID （一台主机可以有多个接口，因此 IPv6 地址表示主机的一个接口更准确）。一个接口可以有一个 IPv4 地址和多个 IPv6 地址。
4. 全球单播地址前缀为 `2000::/3`,开头 4 位为 0010 或 0011，即为十进制的 2 或 3。
5. 对于十分庞大的网络，地址分配机构可以分配长度小于 /48 的前缀。对于只有一个子网可以分配长度是 /64 的前缀。对于一台设备，可以分配长度是 /128 的前缀。

```
  3 bit         45 bit            16 bit          64 bit
    ↑            ↑                 ↑              ↑
 +-----+-----------------------+-----------+------------------+
 | 001 | Global Routing Prefix | Subnet ID |   Interface ID   |
 +-----+-----------------------+-----------+------------------+
```

#### 本地单播地址
1. 唯一本地地址
2. 链路本地地址
3. 未指定地址
4. 回环地址

#### 唯一本地地址
